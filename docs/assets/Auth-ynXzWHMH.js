import{c as g,r as a,j as e,X as N,S as k,L as z,a as c}from"./index-FG92OVs0.js";import{U as C,M as E}from"./user-3vJKsaQB.js";import{A as S}from"./arrow-right-COVTYlDv.js";/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],A=g("circle-alert",q);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],_=g("lock",R),U=()=>e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 384 512",fill:"currentColor",className:"flex-shrink-0",children:e.jsx("path",{d:"M318.7 268.7c-.2-36.7 16.4-64.4 50-84.8-18.8-26.9-47.2-41.7-84.7-44.6-35.5-2.8-74.3 20.7-88.5 20.7-15 0-49.4-19.7-76.4-19.7C63.3 141.2 4 184.8 4 273.5q0 39.3 14.4 81.2c12.8 36.7 59 126.7 107.2 125.2 25.2-.6 43-17.9 75.8-17.9 31.8 0 48.3 17.9 76.4 17.9 48.6-.7 90.4-82.5 102.6-119.3-65.2-30.7-61.7-90-61.7-91.9zm-56.6-164.2c27.3-32.4 24.8-61.9 24-72.5-24.1 1.4-52 16.4-67.9 34.9-17.5 19.8-27.8 44.3-25.6 71.9 26.1 2 49.9-11.4 69.5-34.3z"})}),B=({onClose:b,onLoginSuccess:l})=>{const[n,j]=a.useState(!1),[f,o]=a.useState(!1),[d,w]=a.useState(""),[x,y]=a.useState(""),[h,r]=a.useState(""),m=a.useRef(null);a.useEffect(()=>{const s=async t=>{o(!0),r("");try{const i=await fetch("http://localhost:3001/api/auth/verify-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({idToken:t.credential})});if(!i.ok)throw new Error("Falha na verificação do token");const{user:u}=await i.json();let p=await c.login(u.email);p||(p=await c.createUser(u.name,u.email,"google")),l(p)}catch(i){console.error(i),r("Erro ao autenticar com Google. Verifique sua conexão.")}finally{o(!1)}};window.google&&m.current&&(window.google.accounts.id.initialize({client_id:"309962205395-c36qhp6n9qold6kcd5ii3d4t3q04qvt9.apps.googleusercontent.com",callback:s}),window.google.accounts.id.renderButton(m.current,{type:"standard",theme:"outline",size:"large",text:"signin_with",shape:"pill",width:320}))},[l]);const v=async s=>{s.preventDefault(),o(!0),r("");try{if(n){if(!x.trim())throw new Error("Informe seu nome.");const t=await c.createUser(x,d,"email");l(t)}else{const t=await c.login(d);t?l(t):r("Conta não encontrada. Cadastre-se!")}}catch(t){r(t.message)}finally{o(!1)}};return e.jsx("div",{className:"fixed inset-0 z-[120] flex items-center justify-center p-4 bg-stone-900/80 backdrop-blur-md",children:e.jsxs("div",{className:"bg-white w-full max-w-md rounded-[48px] overflow-hidden shadow-2xl relative",children:[e.jsx("button",{onClick:b,className:"absolute top-8 right-8 p-2 text-stone-300 hover:text-stone-900 transition-colors z-20",children:e.jsx(N,{size:24})}),e.jsxs("div",{className:"p-8 sm:p-12 pb-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 rounded-[28px] bg-orange-50 text-orange-600 mb-6",children:e.jsx(k,{size:36})}),e.jsx("h2",{className:"text-3xl font-black text-stone-900 mb-2",children:"Acesso Seguro"}),e.jsx("p",{className:"text-stone-400 text-sm font-medium",children:"Seus dados são armazenados localmente."})]}),e.jsxs("div",{className:"space-y-6 flex flex-col items-center",children:[e.jsx("div",{ref:m,className:"w-full flex justify-center min-h-[50px]"}),e.jsxs("button",{type:"button",className:"w-full max-w-[320px] flex items-center justify-center gap-3 py-4 bg-stone-900 rounded-full hover:bg-black transition-all font-black text-xs text-white shadow-xl active:scale-95",children:[e.jsx(U,{})," ",e.jsx("span",{children:"Continuar com Apple"})]}),e.jsxs("div",{className:"relative flex items-center justify-center w-full my-2",children:[e.jsx("div",{className:"w-full border-t border-stone-100 absolute"}),e.jsx("span",{className:"relative bg-white px-4 text-[9px] font-black text-stone-300 uppercase tracking-widest",children:"ou e-mail"})]}),e.jsxs("form",{onSubmit:v,className:"w-full space-y-4",children:[n&&e.jsxs("div",{className:"group relative",children:[e.jsx(C,{className:"absolute left-5 top-1/2 -translate-y-1/2 text-stone-300",size:20}),e.jsx("input",{type:"text",value:x,onChange:s=>y(s.target.value),placeholder:"Seu nome",className:"w-full bg-stone-50 border-2 border-stone-50 rounded-2xl pl-14 pr-6 py-4 outline-none focus:border-orange-500/20 focus:bg-white transition-all font-bold"})]}),e.jsxs("div",{className:"group relative",children:[e.jsx(E,{className:"absolute left-5 top-1/2 -translate-y-1/2 text-stone-300",size:20}),e.jsx("input",{type:"email",value:d,onChange:s=>w(s.target.value),placeholder:"E-mail",className:"w-full bg-stone-50 border-2 border-stone-50 rounded-2xl pl-14 pr-6 py-4 outline-none focus:border-orange-500/20 focus:bg-white transition-all font-bold",required:!0})]}),h&&e.jsxs("div",{className:"bg-red-50 text-red-600 p-4 rounded-2xl text-[10px] font-bold uppercase flex gap-3 items-center",children:[e.jsx(A,{size:16}),e.jsx("span",{children:h})]}),e.jsx("button",{type:"submit",disabled:f,className:"w-full bg-orange-500 text-white font-black py-5 rounded-full flex items-center justify-center gap-3 shadow-2xl shadow-orange-100 hover:bg-orange-600 transition-all",children:f?e.jsx(z,{className:"animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:n?"Criar Perfil":"Entrar"}),e.jsx(S,{size:18})]})})]})]}),e.jsx("div",{className:"mt-8 text-center",children:e.jsx("button",{onClick:()=>{j(!n),r("")},className:"text-stone-400 font-bold text-[10px] hover:text-orange-500 transition-colors uppercase tracking-widest",children:n?"Já tem conta? Login":"Novo? Criar perfil local"})}),e.jsx("div",{className:"mt-10 pt-6 border-t border-stone-50 text-center space-y-2",children:e.jsxs("div",{className:"flex items-center justify-center gap-2 text-[10px] font-black text-stone-400 uppercase tracking-widest",children:[e.jsx(_,{size:12,className:"text-green-500"})," App 100% Estático"]})})]})]})})};export{B as Auth};
